var app=angular.module("dewy",["ngRoute","ngAnimate","ui.sortable","dewyControllers","dewyFactories","dewyServices","dewyDirectives"]);app.config(["$httpProvider","$routeProvider","$locationProvider",function(a,b,c){c.html5Mode(!0),a.interceptors.push("authInterceptor"),b.when("/filter/:filter?",{templateUrl:"templates/filter.html",controller:"filterController",requiresAuthorization:!0,resolve:{operators:["filterFactory",function(a){return a.getOperators()}],fields:["filterFactory",function(a){return a.getFields()}],filters:["filterFactory",function(a){return a.getAll()}],currentFilter:["$route","filterFactory",function(a,b){return b.getFilter(a.current.params.filter)}],tags:["sitesFactory",function(a){return a.getTags()}]}}).when("/manage",{templateUrl:"templates/manage.html",controller:"manageController",requiresAuthorization:!0,resolve:{sites:["sitesFactory",function(a){return a.getOffline()}],user:["userFactory",function(a){return a.get()}]}}).when("/signon",{templateUrl:"templates/signon.html",controller:"signonController",requiresAuthorization:!1,indexPage:!0}).when("/sites/:filter?",{templateUrl:"templates/sites.html",controller:"sitesController",requiresAuthorization:!0,resolve:{filters:["filterFactory",function(a){return a.getAll()}],currentFilter:["$route","filterFactory",function(a,b){return a.current.params.filter?b.getFilter(a.current.params.filter):null}]}}).when("/user",{templateUrl:"templates/user.html",controller:"userController",requiresAuthorization:!0}).when("/",{templateUrl:"templates/index.html",requiresAuthorization:!1,indexPage:!0}).otherwise({controller:function(){window.location.replace("/")},template:"<div></div>"})}]),app.run(["authService","$rootScope","$location","$http","$window",function(a,b,c,d,e){b.$on("$routeChangeStart",function(e,f){f.requiresAuthorization?a.isAuthenticated()?(b.currentUser=a.currentUser(),b.currentUser||d.get("http://dewy.io/api/users").success(function(c){a.setUser(c),b.currentUser=c}),b.indexPage=f.indexPage):(e.preventDefault(),c.path("/signon")):a.isAuthenticated()?(e.preventDefault(),c.path("/sites")):(b.currentUser=null,b.indexPage=f.indexPage)})}]);
//# sourceMappingURL=app.js.map