<li class="rule-group-heading" ng-if="rule.operator">
    <select ng-model="rule.operator" ng-options="operator as operator for operator in operators"></select>
    of the following rules:
    <div class="buttons" ng-if="rule._parent" ng-include="'templates/rule_buttons.html'"></div>
</li>
<ul class="rule-group">
    <li class="rule" ng-repeat="rule in rule.rules" ng-form="rulesForm">
        <div ng-if="rule.operator" ng-init="rule._parent=true" ng-include="'templates/filter_tree.html'"></div>
        <div ng-if="!rule.operator">
            <select class="field" ng-model="rule.field" ng-options="field.title as field.title for field in fields" ng-change="updateChoice(rule, '{{rule.field}}')"></select>
            <select class="choice" ng-model="rule.choice" ng-options="choice as choice for choice in getChoices(rule.field)"></select>
            <input name="value" type="text" ng-model="rule.value" ng-if="valueIsType(rule.field, 'string')" required />
            <input name="value" type="number" ng-model="rule.value" ng-if="valueIsType(rule.field, 'integer')" min="0" required />
            <input name="value" type="date" data-format="yyyy-MM-dd" ng-model="rule.value" ng-if="valueIsType(rule.field, 'date')" required />
            <select name="value" ng-model="rule.value" ng-options="tag.id as tag.title for tag in tags" ng-if="valueIsType(rule.field, 'tag')" /></select>
            <div class="buttons" ng-init="rule._parent=true" ng-include="'templates/rule_buttons.html'"></div>
            <div class="error">
                <span ng-show="rulesForm.value.$error.required && (rulesForm.value.$touched || filterForm.$submitted)">Please enter a value.</span>
                <span ng-show="rulesForm.value.$error.number">You must enter a number.</span>
                <span ng-show="rulesForm.value.$error.min">The value cannot be less than 0.</span>
                <span ng-show="rulesForm.value.$error.date">You must enter a date of format YYYY-MM-DD.</span>
            </div>
        </div>
    </li>
</ul>